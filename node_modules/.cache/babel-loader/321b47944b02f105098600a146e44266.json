{"remainingRequest":"C:\\Users\\lenovo\\Desktop\\chatapp\\node_modules\\thread-loader\\dist\\cjs.js!C:\\Users\\lenovo\\Desktop\\chatapp\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\lenovo\\Desktop\\chatapp\\src\\libs\\axios.js","dependencies":[{"path":"C:\\Users\\lenovo\\Desktop\\chatapp\\src\\libs\\axios.js","mtime":1572787192077},{"path":"C:\\Users\\lenovo\\Desktop\\chatapp\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\lenovo\\Desktop\\chatapp\\node_modules\\thread-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\lenovo\\Desktop\\chatapp\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LmtleXMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3QudG8tc3RyaW5nIjsKaW1wb3J0IF9jbGFzc0NhbGxDaGVjayBmcm9tICJDOlxcVXNlcnNcXGxlbm92b1xcRGVza3RvcFxcY2hhdGFwcFxcbm9kZV9tb2R1bGVzXFxAYmFiZWxcXHJ1bnRpbWUvaGVscGVycy9lc20vY2xhc3NDYWxsQ2hlY2siOwppbXBvcnQgX2NyZWF0ZUNsYXNzIGZyb20gIkM6XFxVc2Vyc1xcbGVub3ZvXFxEZXNrdG9wXFxjaGF0YXBwXFxub2RlX21vZHVsZXNcXEBiYWJlbFxccnVudGltZS9oZWxwZXJzL2VzbS9jcmVhdGVDbGFzcyI7CmltcG9ydCBheGlvcyBmcm9tICdheGlvcyc7CmltcG9ydCB7IGdldFRva2VuIH0gZnJvbSAnLi91dGlsJzsKCnZhciBIdHRwUmVxdWVzdCA9Ci8qI19fUFVSRV9fKi8KZnVuY3Rpb24gKCkgewogIGZ1bmN0aW9uIEh0dHBSZXF1ZXN0KCkgewogICAgdmFyIGJhc2VVcmwgPSBhcmd1bWVudHMubGVuZ3RoID4gMCAmJiBhcmd1bWVudHNbMF0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1swXSA6IGJhc2VVUkw7CgogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIEh0dHBSZXF1ZXN0KTsKCiAgICB0aGlzLmJhc2VVcmwgPSBiYXNlVXJsOwogICAgdGhpcy5xdWV1ZSA9IHt9OwogIH0KCiAgX2NyZWF0ZUNsYXNzKEh0dHBSZXF1ZXN0LCBbewogICAga2V5OiAiZ2V0SW5zaWRlQ29uZmlnIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRJbnNpZGVDb25maWcoKSB7CiAgICAgIHZhciB0b2tlbiA9IGdldFRva2VuKCkgfHwgJyc7CiAgICAgIGlmICh0b2tlbiAhPT0gJycpIHRva2VuID0gJyAnICsgdG9rZW47CiAgICAgIHZhciBjb25maWcgPSB7CiAgICAgICAgYmFzZVVSTDogdGhpcy5iYXNlVXJsLAogICAgICAgIGhlYWRlcnM6IHsKICAgICAgICAgICdBdXRob3JpemF0aW9uJzogJ0JlYXJlcicgKyB0b2tlbgogICAgICAgIH0sCiAgICAgICAgd2l0aENyZWRlbnRpYWxzOiB0cnVlCiAgICAgIH07CiAgICAgIHJldHVybiBjb25maWc7CiAgICB9CiAgfSwgewogICAga2V5OiAiZGVzdHJveSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZGVzdHJveSh1cmwpIHsKICAgICAgZGVsZXRlIHRoaXMucXVldWVbdXJsXTsKCiAgICAgIGlmICghT2JqZWN0LmtleXModGhpcy5xdWV1ZSkubGVuZ3RoKSB7fQogICAgfQogIH0sIHsKICAgIGtleTogImludGVyY2VwdG9ycyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gaW50ZXJjZXB0b3JzKGluc3RhbmNlLCB1cmwpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIGluc3RhbmNlLmludGVyY2VwdG9ycy5yZXF1ZXN0LnVzZShmdW5jdGlvbiAoY29uZmlnKSB7CiAgICAgICAgaWYgKCFPYmplY3Qua2V5cyhfdGhpcy5xdWV1ZSkubGVuZ3RoKSB7fQoKICAgICAgICBfdGhpcy5xdWV1ZVt1cmxdID0gdHJ1ZTsKICAgICAgICByZXR1cm4gY29uZmlnOwogICAgICB9LCBmdW5jdGlvbiAoZXJyb3IpIHsKICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoZXJyb3IpOwogICAgICB9KTsgLy8g5ZON5bqU5oum5oiqCgogICAgICBpbnN0YW5jZS5pbnRlcmNlcHRvcnMucmVzcG9uc2UudXNlKGZ1bmN0aW9uIChyZXMpIHsKICAgICAgICBfdGhpcy5kZXN0cm95KHVybCk7CgogICAgICAgIHZhciBkYXRhID0gcmVzLmRhdGEsCiAgICAgICAgICAgIHN0YXR1cyA9IHJlcy5zdGF0dXM7CiAgICAgICAgcmV0dXJuIHsKICAgICAgICAgIGRhdGE6IGRhdGEsCiAgICAgICAgICBzdGF0dXM6IHN0YXR1cwogICAgICAgIH07CiAgICAgIH0sIGZ1bmN0aW9uIChlcnJvcikgewogICAgICAgIF90aGlzLmRlc3Ryb3kodXJsKTsKCiAgICAgICAgdmFyIGVycm9ySW5mbyA9IGVycm9yLnJlc3BvbnNlOwoKICAgICAgICBpZiAoIWVycm9ySW5mbykgewogICAgICAgICAgdmFyIF9KU09OJHBhcnNlID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShlcnJvcikpLAogICAgICAgICAgICAgIF9KU09OJHBhcnNlJHJlcXVlc3QgPSBfSlNPTiRwYXJzZS5yZXF1ZXN0LAogICAgICAgICAgICAgIHN0YXR1c1RleHQgPSBfSlNPTiRwYXJzZSRyZXF1ZXN0LnN0YXR1c1RleHQsCiAgICAgICAgICAgICAgc3RhdHVzID0gX0pTT04kcGFyc2UkcmVxdWVzdC5zdGF0dXMsCiAgICAgICAgICAgICAgY29uZmlnID0gX0pTT04kcGFyc2UuY29uZmlnOwoKICAgICAgICAgIGVycm9ySW5mbyA9IHsKICAgICAgICAgICAgc3RhdHVzVGV4dDogc3RhdHVzVGV4dCwKICAgICAgICAgICAgc3RhdHVzOiBzdGF0dXMsCiAgICAgICAgICAgIHJlcXVlc3Q6IHsKICAgICAgICAgICAgICByZXNwb25zZVVSTDogY29uZmlnLnVybAogICAgICAgICAgICB9CiAgICAgICAgICB9OwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGVycm9yKTsKICAgICAgfSk7CiAgICB9CiAgfSwgewogICAga2V5OiAicmVxdWVzdCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gcmVxdWVzdChvcHRpb25zKSB7CiAgICAgIHZhciBpbnN0YW5jZSA9IGF4aW9zLmNyZWF0ZSgpOwogICAgICBvcHRpb25zID0gT2JqZWN0LmFzc2lnbih0aGlzLmdldEluc2lkZUNvbmZpZygpLCBvcHRpb25zKTsKICAgICAgdGhpcy5pbnRlcmNlcHRvcnMoaW5zdGFuY2UsIG9wdGlvbnMudXJsKTsKICAgICAgcmV0dXJuIGluc3RhbmNlKG9wdGlvbnMpOwogICAgfQogIH1dKTsKCiAgcmV0dXJuIEh0dHBSZXF1ZXN0Owp9KCk7CgpleHBvcnQgZGVmYXVsdCBIdHRwUmVxdWVzdDs="},{"version":3,"sources":["C:/Users/lenovo/Desktop/chatapp/src/libs/axios.js"],"names":["axios","getToken","HttpRequest","baseUrl","baseURL","queue","token","config","headers","withCredentials","url","Object","keys","length","instance","interceptors","request","use","error","Promise","reject","response","res","destroy","data","status","errorInfo","JSON","parse","stringify","statusText","responseURL","options","create","assign","getInsideConfig"],"mappings":";;;;AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,SAASC,QAAT,QAAyB,QAAzB;;IAGMC,W;;;AACJ,yBAAgC;AAAA,QAAnBC,OAAmB,uEAATC,OAAS;;AAAA;;AAC9B,SAAKD,OAAL,GAAeA,OAAf;AACA,SAAKE,KAAL,GAAa,EAAb;AACD;;;;sCACkB;AACjB,UAAIC,KAAK,GAAGL,QAAQ,MAAM,EAA1B;AACA,UAAIK,KAAK,KAAK,EAAd,EAAmBA,KAAK,GAAG,MAAMA,KAAd;AACnB,UAAMC,MAAM,GAAG;AACbH,QAAAA,OAAO,EAAE,KAAKD,OADD;AAEbK,QAAAA,OAAO,EAAE;AACP,2BAAiB,WAAWF;AADrB,SAFI;AAKbG,QAAAA,eAAe,EAAE;AALJ,OAAf;AAOA,aAAOF,MAAP;AACD;;;4BACQG,G,EAAK;AACZ,aAAO,KAAKL,KAAL,CAAWK,GAAX,CAAP;;AACA,UAAI,CAACC,MAAM,CAACC,IAAP,CAAY,KAAKP,KAAjB,EAAwBQ,MAA7B,EAAqC,CACpC;AACF;;;iCACaC,Q,EAAUJ,G,EAAK;AAAA;;AAC3BI,MAAAA,QAAQ,CAACC,YAAT,CAAsBC,OAAtB,CAA8BC,GAA9B,CAAkC,UAAAV,MAAM,EAAI;AAC1C,YAAI,CAACI,MAAM,CAACC,IAAP,CAAY,KAAI,CAACP,KAAjB,EAAwBQ,MAA7B,EAAqC,CACpC;;AACD,QAAA,KAAI,CAACR,KAAL,CAAWK,GAAX,IAAkB,IAAlB;AACA,eAAOH,MAAP;AACD,OALD,EAKG,UAAAW,KAAK,EAAI;AACV,eAAOC,OAAO,CAACC,MAAR,CAAeF,KAAf,CAAP;AACD,OAPD,EAD2B,CAS3B;;AACAJ,MAAAA,QAAQ,CAACC,YAAT,CAAsBM,QAAtB,CAA+BJ,GAA/B,CAAmC,UAAAK,GAAG,EAAI;AACxC,QAAA,KAAI,CAACC,OAAL,CAAab,GAAb;;AADwC,YAEhCc,IAFgC,GAEfF,GAFe,CAEhCE,IAFgC;AAAA,YAE1BC,MAF0B,GAEfH,GAFe,CAE1BG,MAF0B;AAGxC,eAAO;AAAED,UAAAA,IAAI,EAAJA,IAAF;AAAQC,UAAAA,MAAM,EAANA;AAAR,SAAP;AACD,OAJD,EAIG,UAAAP,KAAK,EAAI;AACV,QAAA,KAAI,CAACK,OAAL,CAAab,GAAb;;AACA,YAAIgB,SAAS,GAAGR,KAAK,CAACG,QAAtB;;AACA,YAAI,CAACK,SAAL,EAAgB;AAAA,4BACsCC,IAAI,CAACC,KAAL,CAAWD,IAAI,CAACE,SAAL,CAAeX,KAAf,CAAX,CADtC;AAAA,gDACNF,OADM;AAAA,cACKc,UADL,uBACKA,UADL;AAAA,cACiBL,MADjB,uBACiBA,MADjB;AAAA,cAC2BlB,MAD3B,eAC2BA,MAD3B;;AAEdmB,UAAAA,SAAS,GAAG;AACVI,YAAAA,UAAU,EAAVA,UADU;AAEVL,YAAAA,MAAM,EAANA,MAFU;AAGVT,YAAAA,OAAO,EAAE;AAAEe,cAAAA,WAAW,EAAExB,MAAM,CAACG;AAAtB;AAHC,WAAZ;AAKD;;AACD,eAAOS,OAAO,CAACC,MAAR,CAAeF,KAAf,CAAP;AACD,OAhBD;AAiBD;;;4BACQc,O,EAAS;AAChB,UAAMlB,QAAQ,GAAGd,KAAK,CAACiC,MAAN,EAAjB;AACAD,MAAAA,OAAO,GAAGrB,MAAM,CAACuB,MAAP,CAAc,KAAKC,eAAL,EAAd,EAAsCH,OAAtC,CAAV;AACA,WAAKjB,YAAL,CAAkBD,QAAlB,EAA4BkB,OAAO,CAACtB,GAApC;AACA,aAAOI,QAAQ,CAACkB,OAAD,CAAf;AACD;;;;;;AAEH,eAAe9B,WAAf","sourcesContent":["import axios from 'axios'\r\nimport { getToken } from './util'\r\n\r\n\r\nclass HttpRequest {\r\n  constructor (baseUrl = baseURL) {\r\n    this.baseUrl = baseUrl\r\n    this.queue = {}\r\n  }\r\n  getInsideConfig () {\r\n    let token = getToken() || ''\r\n    if( token !== '' ) token = ' ' + token;\r\n    const config = {\r\n      baseURL: this.baseUrl,\r\n      headers: {\r\n        'Authorization': 'Bearer' + token\r\n      },\r\n      withCredentials: true\r\n    }\r\n    return config\r\n  }\r\n  destroy (url) {\r\n    delete this.queue[url]\r\n    if (!Object.keys(this.queue).length) {\r\n    }\r\n  }\r\n  interceptors (instance, url) {\r\n    instance.interceptors.request.use(config => {\r\n      if (!Object.keys(this.queue).length) {\r\n      }\r\n      this.queue[url] = true\r\n      return config\r\n    }, error => {\r\n      return Promise.reject(error)\r\n    })\r\n    // 响应拦截\r\n    instance.interceptors.response.use(res => {\r\n      this.destroy(url)\r\n      const { data, status } = res\r\n      return { data, status }\r\n    }, error => {\r\n      this.destroy(url)\r\n      let errorInfo = error.response\r\n      if (!errorInfo) {\r\n        const { request: { statusText, status }, config } = JSON.parse(JSON.stringify(error))\r\n        errorInfo = {\r\n          statusText,\r\n          status,\r\n          request: { responseURL: config.url }\r\n        }\r\n      }\r\n      return Promise.reject(error)\r\n    })\r\n  }\r\n  request (options) {\r\n    const instance = axios.create()\r\n    options = Object.assign(this.getInsideConfig(), options)\r\n    this.interceptors(instance, options.url)\r\n    return instance(options)\r\n  }\r\n}\r\nexport default HttpRequest\r\n"]}]}