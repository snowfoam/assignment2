{"remainingRequest":"C:\\Users\\lenovo\\Desktop\\chatapp\\node_modules\\thread-loader\\dist\\cjs.js!C:\\Users\\lenovo\\Desktop\\chatapp\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\lenovo\\Desktop\\chatapp\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!C:\\Users\\lenovo\\Desktop\\chatapp\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\lenovo\\Desktop\\chatapp\\src\\components\\Home\\Message.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\lenovo\\Desktop\\chatapp\\src\\components\\Home\\Message.vue","mtime":1576302790637},{"path":"C:\\Users\\lenovo\\Desktop\\chatapp\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\lenovo\\Desktop\\chatapp\\node_modules\\thread-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\lenovo\\Desktop\\chatapp\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\Users\\lenovo\\Desktop\\chatapp\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\lenovo\\Desktop\\chatapp\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3ltYm9sIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuY29uY2F0IjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZmlsdGVyIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LmdldC1vd24tcHJvcGVydHktZGVzY3JpcHRvciI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC5nZXQtb3duLXByb3BlcnR5LWRlc2NyaXB0b3JzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LmtleXMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3QudG8tc3RyaW5nIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMucmVnZXhwLnRvLXN0cmluZyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5wYWQtc3RhcnQiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy93ZWIuZG9tLWNvbGxlY3Rpb25zLmZvci1lYWNoIjsKaW1wb3J0IF9kZWZpbmVQcm9wZXJ0eSBmcm9tICJDOlxcVXNlcnNcXGxlbm92b1xcRGVza3RvcFxcY2hhdGFwcFxcbm9kZV9tb2R1bGVzXFxAYmFiZWxcXHJ1bnRpbWUvaGVscGVycy9lc20vZGVmaW5lUHJvcGVydHkiOwoKZnVuY3Rpb24gb3duS2V5cyhvYmplY3QsIGVudW1lcmFibGVPbmx5KSB7IHZhciBrZXlzID0gT2JqZWN0LmtleXMob2JqZWN0KTsgaWYgKE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMpIHsgdmFyIHN5bWJvbHMgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKG9iamVjdCk7IGlmIChlbnVtZXJhYmxlT25seSkgc3ltYm9scyA9IHN5bWJvbHMuZmlsdGVyKGZ1bmN0aW9uIChzeW0pIHsgcmV0dXJuIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iob2JqZWN0LCBzeW0pLmVudW1lcmFibGU7IH0pOyBrZXlzLnB1c2guYXBwbHkoa2V5cywgc3ltYm9scyk7IH0gcmV0dXJuIGtleXM7IH0KCmZ1bmN0aW9uIF9vYmplY3RTcHJlYWQodGFyZ2V0KSB7IGZvciAodmFyIGkgPSAxOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKSB7IHZhciBzb3VyY2UgPSBhcmd1bWVudHNbaV0gIT0gbnVsbCA/IGFyZ3VtZW50c1tpXSA6IHt9OyBpZiAoaSAlIDIpIHsgb3duS2V5cyhPYmplY3Qoc291cmNlKSwgdHJ1ZSkuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7IF9kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwgc291cmNlW2tleV0pOyB9KTsgfSBlbHNlIGlmIChPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycykgeyBPYmplY3QuZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3JzKHNvdXJjZSkpOyB9IGVsc2UgeyBvd25LZXlzKE9iamVjdChzb3VyY2UpKS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwga2V5LCBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKHNvdXJjZSwga2V5KSk7IH0pOyB9IH0gcmV0dXJuIHRhcmdldDsgfQoKLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KaW1wb3J0IHsgbWFwR2V0dGVycyB9IGZyb20gInZ1ZXgiOwppbXBvcnQgeyBnZXRBbGxNZXNzYWdlIH0gZnJvbSAiQC9hcGkvY2hhdCI7CmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAibWVzc2FnZSIsCiAgZGF0YTogZnVuY3Rpb24gZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIGxpc3Q6IFtdLAogICAgICBsb2FkaW5nOiBmYWxzZSwKICAgICAgZmluaXNoZWQ6IGZhbHNlLAogICAgICBkYXRhOiAiIiwKICAgICAgaXNSZWZyZXNoOiBmYWxzZQogICAgfTsKICB9LAogIGNyZWF0ZWQ6IGZ1bmN0aW9uIGNyZWF0ZWQoKSB7CiAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgIHRoaXMubG9hZGluZyA9IHRydWU7CiAgICBnZXRBbGxNZXNzYWdlKCkudGhlbihmdW5jdGlvbiAocmVzKSB7CiAgICAgIF90aGlzLmRhdGEgPSByZXMuZGF0YS5kYXRhOwogICAgICBfdGhpcy5sb2FkaW5nID0gZmFsc2U7CiAgICAgIF90aGlzLmZpbmlzaGVkID0gdHJ1ZTsKICAgIH0pOwogIH0sCiAgbWV0aG9kczogewogICAgY2hhdDogZnVuY3Rpb24gY2hhdChpdGVtKSB7CiAgICAgIHZhciBmcm9tID0gdGhpcy5faWQ7CiAgICAgIHZhciB0byA9IGl0ZW0udG8uX2lkOwogICAgICB0aGlzLiRyb3V0ZXIucHVzaCh7CiAgICAgICAgbmFtZTogImNoYXRvbmUiLAogICAgICAgIHBhcmFtczogewogICAgICAgICAgZnJvbTogZnJvbSwKICAgICAgICAgIHRvOiB0bywKICAgICAgICAgIGZyaWVuZDogaXRlbS50bwogICAgICAgIH0KICAgICAgfSk7CiAgICB9LAogICAgb25SZWZyZXNoOiBmdW5jdGlvbiBvblJlZnJlc2goKSB7CiAgICAgIHZhciBfdGhpczIgPSB0aGlzOwoKICAgICAgdGhpcy5sb2FkaW5nID0gdHJ1ZTsKICAgICAgZ2V0QWxsTWVzc2FnZSgpLnRoZW4oZnVuY3Rpb24gKHJlcykgewogICAgICAgIF90aGlzMi5kYXRhID0gcmVzLmRhdGEuZGF0YTsKICAgICAgICBfdGhpczIubG9hZGluZyA9IGZhbHNlOwogICAgICAgIF90aGlzMi5maW5pc2hlZCA9IHRydWU7CiAgICAgICAgX3RoaXMyLmlzUmVmcmVzaCA9IGZhbHNlOwogICAgICB9KTsKICAgIH0KICB9LAogIGNvbXB1dGVkOiBfb2JqZWN0U3ByZWFkKHt9LCBtYXBHZXR0ZXJzKFsiX2lkIiwgInVzZXJJbmZvIl0pKSwKICBmaWx0ZXJzOiB7CiAgICBwYXJzZU1lc3NhZ2VUaW1lOiBmdW5jdGlvbiBwYXJzZU1lc3NhZ2VUaW1lKG9sZF90aW1lKSB7CiAgICAgIHZhciBub3cgPSBuZXcgRGF0ZSgpLAogICAgICAgICAgb2xkID0gbmV3IERhdGUob2xkX3RpbWUpLAogICAgICAgICAgbm93X3llYXIgPSBub3cuZ2V0RnVsbFllYXIoKSwKICAgICAgICAgIG9sZF95ZWFyID0gb2xkLmdldEZ1bGxZZWFyKCksCiAgICAgICAgICBub3dfbW9udGggPSBub3cuZ2V0TW9udGgoKSArIDEsCiAgICAgICAgICBvbGRfbW9udGggPSBvbGQuZ2V0TW9udGgoKSArIDEsCiAgICAgICAgICBub3dfZGF0ZSA9IG5vdy5nZXREYXRlKCksCiAgICAgICAgICBvbGRfZGF0ZSA9IG9sZC5nZXREYXRlKCksCiAgICAgICAgICBmb3JtYXRfbW9udGggPSBvbGRfbW9udGgudG9TdHJpbmcoKS5wYWRTdGFydCgyLCAiMCIpLAogICAgICAgICAgZm9ybWF0X2RhdGUgPSBvbGRfZGF0ZS50b1N0cmluZygpLnBhZFN0YXJ0KDIsICIwIiksCiAgICAgICAgICBmb3JtYXRfbWludXRlcyA9IG9sZC5nZXRNaW51dGVzKCkudG9TdHJpbmcoKS5wYWRTdGFydCgyLCAiMCIpLAogICAgICAgICAgZGF5QXJyID0gWyLmmJ/mnJ/ml6UiLCAi5pif5pyf5LiAIiwgIuaYn+acn+S6jCIsICLmmJ/mnJ/kuIkiLCAi5pif5pyf5ZubIiwgIuaYn+acn+S6lCIsICLmmJ/mnJ/lha0iXTsKCiAgICAgIGlmIChub3dfeWVhciA9PSBvbGRfeWVhcikgewogICAgICAgIGlmIChub3dfbW9udGggPT0gb2xkX21vbnRoICYmIG5vd19kYXRlIC0gb2xkX2RhdGUgPCA3KSB7CiAgICAgICAgICBpZiAobm93X2RhdGUgPT0gb2xkX2RhdGUpIHsKICAgICAgICAgICAgcmV0dXJuICIiLmNvbmNhdChvbGQuZ2V0SG91cnMoKSwgIjoiKS5jb25jYXQoZm9ybWF0X21pbnV0ZXMpOwogICAgICAgICAgfSBlbHNlIGlmIChub3dfZGF0ZSA9PSBvbGRfZGF0ZSArIDEpIHsKICAgICAgICAgICAgcmV0dXJuICLmmKjlpKkiOwogICAgICAgICAgfSBlbHNlIGlmIChub3dfZGF0ZSA9PSBvbGRfZGF0ZSArIDIpIHsKICAgICAgICAgICAgcmV0dXJuICLliY3lpKkiOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgcmV0dXJuIGRheUFycltvbGQuZ2V0RGF5KCldOwogICAgICAgICAgfQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICByZXR1cm4gIiIuY29uY2F0KGZvcm1hdF9tb250aCwgIi0iKS5jb25jYXQoZm9ybWF0X2RhdGUpOwogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICByZXR1cm4gIiIuY29uY2F0KG9sZF95ZWFyLCAiLSIpLmNvbmNhdChmb3JtYXRfbW9udGgsICItIikuY29uY2F0KGZvcm1hdF9kYXRlKTsKICAgICAgfQogICAgfQogIH0KfTs="},{"version":3,"sources":["Message.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\r\n  <div>\r\n    <van-pull-refresh v-model=\"isRefresh\" @refresh=\"onRefresh\" style=\"width:100%;height:100%;\">\r\n      <van-list v-model=\"loading\" :finished=\"finished\" finished-text=\"No more\">\r\n        <van-cell id=\"click\" v-for=\"(item,index) in data\" :key=\"item+index\" @click=\"chat(item)\">\r\n          <van-image\r\n            id=\"friendavatar\"\r\n            fit=\"cover\"\r\n            round\r\n            width=\"40px\"\r\n            height=\"40px\"\r\n            :src=\"item.to.avatar\"\r\n            slot=\"icon\"\r\n          />\r\n          <span id=\"fdnickname\" slot=\"title\" style=\"margin-left:16px;\">{{item.to.nickName}}</span>\r\n          <span id=\"fdmessage\" slot=\"label\" style=\"margin-left:16px;\">{{item.message}}</span>\r\n          <span\r\n            slot=\"right-icon\"\r\n            style=\"font-size: 8px;color:#aaa\"\r\n          >{{item.created | parseMessageTime}}</span>\r\n        </van-cell>\r\n      </van-list>\r\n    </van-pull-refresh>\r\n  </div>\r\n</template>\r\n<script>\r\nimport { mapGetters } from \"vuex\";\r\nimport { getAllMessage } from \"@/api/chat\";\r\nexport default {\r\n  name: \"message\",\r\n  data() {\r\n    return {\r\n      list: [],\r\n      loading: false,\r\n      finished: false,\r\n      data: \"\",\r\n      isRefresh: false\r\n    };\r\n  },\r\n  created() {\r\n    this.loading = true;\r\n    getAllMessage().then(res => {\r\n      this.data = res.data.data;\r\n      this.loading = false;\r\n      this.finished = true;\r\n    });\r\n  },\r\n  methods: {\r\n    chat(item) {\r\n      let from = this._id;\r\n      let to = item.to._id;\r\n      this.$router.push({\r\n        name: \"chatone\",\r\n        params: {\r\n          from,\r\n          to,\r\n          friend: item.to\r\n        }\r\n      });\r\n    },\r\n    onRefresh() {\r\n      this.loading = true;\r\n      getAllMessage().then(res => {\r\n        this.data = res.data.data;\r\n        this.loading = false;\r\n        this.finished = true;\r\n        this.isRefresh = false;\r\n      });\r\n    }\r\n  },\r\n  computed: {\r\n    ...mapGetters([\"_id\", \"userInfo\"])\r\n  },\r\n  filters: {\r\n    parseMessageTime(old_time) {\r\n      let now = new Date(),\r\n        old = new Date(old_time),\r\n        now_year = now.getFullYear(),\r\n        old_year = old.getFullYear(),\r\n        now_month = now.getMonth() + 1,\r\n        old_month = old.getMonth() + 1,\r\n        now_date = now.getDate(),\r\n        old_date = old.getDate(),\r\n        format_month = old_month.toString().padStart(2, \"0\"),\r\n        format_date = old_date.toString().padStart(2, \"0\"),\r\n        format_minutes = old\r\n          .getMinutes()\r\n          .toString()\r\n          .padStart(2, \"0\"),\r\n        dayArr = [\r\n          \"星期日\",\r\n          \"星期一\",\r\n          \"星期二\",\r\n          \"星期三\",\r\n          \"星期四\",\r\n          \"星期五\",\r\n          \"星期六\"\r\n        ];\r\n      if (now_year == old_year) {\r\n        if (now_month == old_month && now_date - old_date < 7) {\r\n          if (now_date == old_date) {\r\n            return `${old.getHours()}:${format_minutes}`;\r\n          } else if (now_date == old_date + 1) {\r\n            return \"昨天\";\r\n          } else if (now_date == old_date + 2) {\r\n            return \"前天\";\r\n          } else {\r\n            return dayArr[old.getDay()];\r\n          }\r\n        } else {\r\n          return `${format_month}-${format_date}`;\r\n        }\r\n      } else {\r\n        return `${old_year}-${format_month}-${format_date}`;\r\n      }\r\n    }\r\n  }\r\n};\r\n</script>\r\n<style scoped lang=\"less\">\r\n</style>"],"sourceRoot":"src/components/Home"}]}