{"remainingRequest":"C:\\Users\\lenovo\\Desktop\\chatapp\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\lenovo\\Desktop\\chatapp\\src\\components\\Home\\Friends.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\lenovo\\Desktop\\chatapp\\src\\components\\Home\\Friends.vue","mtime":1576298763305},{"path":"C:\\Users\\lenovo\\Desktop\\chatapp\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\Users\\lenovo\\Desktop\\chatapp\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\lenovo\\Desktop\\chatapp\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQgeyBnZXRGcmllbmROZXdzLCByZXBseSB9IGZyb20gIkAvYXBpL2ZyaWVuZCI7DQoNCmltcG9ydCB7IG1hcEdldHRlcnMgfSBmcm9tICJ2dWV4IjsNCmV4cG9ydCBkZWZhdWx0IHsNCiAgbmFtZTogImZyaWVuZHMiLA0KICBkYXRhKCkgew0KICAgIHJldHVybiB7DQogICAgICBhY3RpdmVOYW1lOiAiYSIsDQogICAgICBsaXN0OiBbXSwNCiAgICAgIGxvYWRpbmc6IGZhbHNlLA0KICAgICAgZmluaXNoZWQ6IHRydWUsDQogICAgICBpc1Nob3c6IGZhbHNlLA0KICAgICAgZGF0YTogW10sDQogICAgICBmcmllbmRMb2FkaW5nOiBmYWxzZSwNCiAgICAgIEZyaWVuZEZpbmlzaGVkOiBmYWxzZSwNCiAgICAgIGlzUmVmcmVzaDogZmFsc2UNCiAgICB9Ow0KICB9LA0KICBjb21wdXRlZDogew0KICAgIC4uLm1hcEdldHRlcnMoWyJfaWQiLCAidXNlckluZm8iXSkNCiAgfSwNCiAgY3JlYXRlZCgpIHsNCiAgICB0aGlzLmdldE5ld3MoKTsNCiAgfSwNCiAgbWV0aG9kczogew0KICAgIHNob3coKSB7DQogICAgICB0aGlzLmlzU2hvdyA9IHRydWU7DQogICAgfSwNCiAgICBoYW5kbGVjbGljayhzdGF0dXMsIGluZGV4KSB7DQogICAgICBsZXQgaWQgPSB0aGlzLmRhdGFbaW5kZXhdLl9pZDsNCiAgICAgIHJlcGx5KHsgc3RhdHVzLCBpZCB9KS50aGVuKHJlcyA9PiB7DQogICAgICAgIGlmIChyZXMuc3RhdHVzID09PSAyMDApIHsNCiAgICAgICAgICB0aGlzLmdldE5ld3MoKTsNCiAgICAgICAgICB0aGlzLiRzdG9yZS5kaXNwYXRjaCgiZ2V0VXNlckluZm8iKTsNCiAgICAgICAgICByZXR1cm4gdGhpcy4kbm90aWZ5KHsgdHlwZTogInN1Y2Nlc3MiLCBtZXNzYWdlOiByZXMuZGF0YS5tZXNzYWdlIH0pOw0KICAgICAgICB9DQogICAgICAgIHRoaXMuJG5vdGlmeShyZXMuZGF0YS5tZXNzYWdlKTsNCiAgICAgIH0pOw0KICAgIH0sDQogICAgZ2V0TmV3cygpIHsNCiAgICAgIHRoaXMuZnJpZW5kTG9hZGluZyA9IHRydWU7DQogICAgICBnZXRGcmllbmROZXdzKCkudGhlbihyZXMgPT4gew0KICAgICAgICB0aGlzLmRhdGEgPSByZXMuZGF0YS5kYXRhOw0KICAgICAgICB0aGlzLmZyaWVuZExvYWRpbmcgPSBmYWxzZTsNCiAgICAgICAgdGhpcy5GcmllbmRGaW5pc2hlZCA9IHRydWU7DQogICAgICB9KTsNCiAgICB9LA0KICAgIGNoYXQoaW5kZXgpIHsNCiAgICAgIGxldCBmcm9tID0gdGhpcy5faWQ7DQogICAgICBsZXQgdG8gPSB0aGlzLnVzZXJJbmZvLmZyaWVuZHNbaW5kZXhdLl9pZDsNCiAgICAgIHRoaXMuJHJvdXRlci5wdXNoKHsNCiAgICAgICAgbmFtZTogImNoYXRvbmUiLA0KICAgICAgICBwYXJhbXM6IHsNCiAgICAgICAgICBmcm9tLA0KICAgICAgICAgIHRvLA0KICAgICAgICAgIGZyaWVuZDogdGhpcy51c2VySW5mby5mcmllbmRzW2luZGV4XQ0KICAgICAgICB9DQogICAgICB9KTsNCiAgICB9LA0KICAgIG9uUmVmcmVzaCgpIHsNCiAgICAgIHRoaXMuZ2V0TmV3cygpOw0KICAgICAgdGhpcy4kc3RvcmUuZGlzcGF0Y2goImdldFVzZXJJbmZvIikudGhlbihyZXMgPT4gew0KICAgICAgICB0aGlzLmlzUmVmcmVzaCA9IGZhbHNlOw0KICAgICAgfSk7DQogICAgfQ0KICB9DQp9Ow0K"},{"version":3,"sources":["Friends.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAkEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Friends.vue","sourceRoot":"src/components/Home","sourcesContent":["<template>\r\n  <meta http-equiv=\"Access-Control-Allow-Origin\" content=\"*\">\r\n  <div>\r\n    <van-pull-refresh v-model=\"isRefresh\" @refresh=\"onRefresh\">\r\n      <van-cell id=\"title1\" title=\"New Friend\" value=\">\" size=\"large\" @click=\"show\" />\r\n      <div style=\"height: 80vh;\"><!--查看自己的好友-->\r\n        <van-list v-model=\"loading\" :finished=\"finished\" finished-text=\"No more\">\r\n          <van-cell id=\"chatfriend\" v-for=\"(item,index) in userInfo.friends\" :key=\"item+index\" @click=\"chat(index)\">//点击头像聊天\r\n            <van-image fit=\"cover\" round width=\"40px\" height=\"40px\" :src=\"item.avatar\" slot=\"icon\" />\r\n            <span id=\"friendnick\" slot=\"title\" style=\"margin-left:16px;\">{{item.nickName}}</span>\r\n            <span id=\"friendsignature\" slot=\"label\" style=\"margin-left:16px;\">{{item.signature}}</span>\r\n          </van-cell>\r\n        </van-list>\r\n      </div>\r\n      <van-popup v-model=\"isShow\" position=\"bottom\" style=\"height:100%;width:100%;\">\r\n        <van-nav-bar id=\"newfriendclick\" title=\"New Friendsss\" left-arrow @click-left=\"isShow = false\" />\r\n        <van-list v-model=\"friendLoading\" :finished=\"FriendFinished\" finished-text=\"No more\">\r\n          <van-cell v-for=\"(item,index) in data\" :key=\"index\">\r\n            <van-image\r\n              id=\"friendinfo\"\r\n              fit=\"cover\"\r\n              round\r\n              width=\"40px\"\r\n              height=\"40px\"\r\n              :src=\"_id===item.to._id? item.from.avatar: item.to.avatar\"\r\n              slot=\"icon\"\r\n            />\r\n            <span\r\n              id=\"nickname\"\r\n              slot=\"title\"\r\n              style=\"margin-left:16px;\"\r\n            >{{_id===item.to._id? item.from.nickName: item.to.nickName}}</span>\r\n            <div slot=\"label\" style=\"margin-left:16px;display: flex;justify-content:space-between\">\r\n              <div id=\"message\">{{item.message}}</div>\r\n              <div v-if=\"!(_id === item.to.id) \">\r\n                <div v-if=\"item.status === 0\">\r\n                  <van-button\r\n                    id=\"butaccept\"\r\n                    size=\"small\"\r\n                    type=\"info\"\r\n                    style=\"maring-right: 5px;\"\r\n                    @click=\"handleclick(1,index)\"\r\n                  >Accept</van-button>\r\n                  <van-button id=\"butrefuse\" size=\"small\" type=\"danger\" @click=\"handleclick(2,index)\">Refuse</van-button>\r\n                </div>\r\n                <div>\r\n                  <span id=\"accpted1\">{{item.status === 1?'Accepted':'Refused'}}</span>\r\n                </div>\r\n              </div>\r\n              <div v-if=\"(_id === item.to.id)\">\r\n                <span id=\"accept2\">{{item.status ===0?'Loading':item.status === 1?'Accepted':'Refused'}}</span>\r\n              </div>\r\n            </div>\r\n            <div\r\n              v-if=\"!(_id === item.to.id)\"\r\n              slot=\"label\"\r\n              style=\"margin-left:16px;\"\r\n            >Source：{{item.source}}</div>\r\n          </van-cell>\r\n        </van-list>\r\n      </van-popup>\r\n    </van-pull-refresh>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { getFriendNews, reply } from \"@/api/friend\";\r\n\r\nimport { mapGetters } from \"vuex\";\r\nexport default {\r\n  name: \"friends\",\r\n  data() {\r\n    return {\r\n      activeName: \"a\",\r\n      list: [],\r\n      loading: false,\r\n      finished: true,\r\n      isShow: false,\r\n      data: [],\r\n      friendLoading: false,\r\n      FriendFinished: false,\r\n      isRefresh: false\r\n    };\r\n  },\r\n  computed: {\r\n    ...mapGetters([\"_id\", \"userInfo\"])\r\n  },\r\n  created() {\r\n    this.getNews();\r\n  },\r\n  methods: {\r\n    show() {\r\n      this.isShow = true;\r\n    },\r\n    handleclick(status, index) {\r\n      let id = this.data[index]._id;\r\n      reply({ status, id }).then(res => {\r\n        if (res.status === 200) {\r\n          this.getNews();\r\n          this.$store.dispatch(\"getUserInfo\");\r\n          return this.$notify({ type: \"success\", message: res.data.message });\r\n        }\r\n        this.$notify(res.data.message);\r\n      });\r\n    },\r\n    getNews() {\r\n      this.friendLoading = true;\r\n      getFriendNews().then(res => {\r\n        this.data = res.data.data;\r\n        this.friendLoading = false;\r\n        this.FriendFinished = true;\r\n      });\r\n    },\r\n    chat(index) {\r\n      let from = this._id;\r\n      let to = this.userInfo.friends[index]._id;\r\n      this.$router.push({\r\n        name: \"chatone\",\r\n        params: {\r\n          from,\r\n          to,\r\n          friend: this.userInfo.friends[index]\r\n        }\r\n      });\r\n    },\r\n    onRefresh() {\r\n      this.getNews();\r\n      this.$store.dispatch(\"getUserInfo\").then(res => {\r\n        this.isRefresh = false;\r\n      });\r\n    }\r\n  }\r\n};\r\n</script>"]}]}