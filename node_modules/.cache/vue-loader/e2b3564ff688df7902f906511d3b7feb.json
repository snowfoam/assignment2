{"remainingRequest":"C:\\Users\\lenovo\\Desktop\\chatapp\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\lenovo\\Desktop\\chatapp\\src\\components\\Home\\articleDetail.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\lenovo\\Desktop\\chatapp\\src\\components\\Home\\articleDetail.vue","mtime":1575941918300},{"path":"C:\\Users\\lenovo\\Desktop\\chatapp\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\Users\\lenovo\\Desktop\\chatapp\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\lenovo\\Desktop\\chatapp\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQgeyBjcmVhdGVBcnRpY2xlLCBnZXRBcnRpY2xlcywgYWRkQ29tbWVudCB9IGZyb20gIkAvYXBpL2FydGljbGUiOw0KDQpleHBvcnQgZGVmYXVsdCB7DQogIG5hbWU6ICJBcnRpY2xlIiwNCiAgZGF0YSgpIHsNCiAgICByZXR1cm4gew0KICAgICAgbGlzdDogW10sDQogICAgICBjb250ZW50OiAiIiwNCiAgICAgIGlzU2hvdzogZmFsc2UsDQogICAgICBhZGRTaG93OiBmYWxzZSwNCiAgICAgIG1lc3NhZ2U6ICIiLA0KICAgICAgc2Nyb2xsOiAiIiwNCiAgICAgIGlzUmVmcmVzaDogZmFsc2UNCiAgICB9Ow0KICB9LA0KICBjcmVhdGVkKCkgew0KICAgIHRoaXMuZ2V0QXJ0aWNsZSgpOw0KICB9LA0KICBtZXRob2RzOiB7DQogICAgY3JlYXRlKCkgew0KICAgICAgY3JlYXRlQXJ0aWNsZSh7IGNvbnRlbnQ6IHRoaXMubWVzc2FnZSB9KS50aGVuKHJlcyA9PiB7DQogICAgICAgIGlmIChyZXMuc3RhdHVzID09PSAyMDApIHsNCiAgICAgICAgICB0aGlzLm1lc3NhZ2UgPSAiIjsNCiAgICAgICAgICB0aGlzLmFkZFNob3cgPSBmYWxzZTsNCiAgICAgICAgICB0aGlzLmdldEFydGljbGUoKTsNCiAgICAgICAgICByZXR1cm4gdGhpcy4kbm90aWZ5KHsgdHlwZTogInN1Y2Nlc3MiLCBtZXNzYWdlOiByZXMuZGF0YS5tZXNzYWdlIH0pOw0KICAgICAgICB9DQogICAgICAgIHRoaXMuJG5vdGlmeShyZXMuZGF0YS5tZXNzYWdlKTsNCiAgICAgIH0pOw0KICAgIH0sDQogICAgc2hvdyhpbmRleCkgew0KICAgICAgdGhpcy5jb250ZW50ID0gIiI7DQogICAgICBsZXQgZGF0YSA9IHRoaXMubGlzdDsNCiAgICAgIGRhdGEgPSBkYXRhLm1hcChlID0+IHsNCiAgICAgICAgZS5pc1Nob3cgPSBmYWxzZTsNCiAgICAgICAgcmV0dXJuIGU7DQogICAgICB9KTsNCiAgICAgIGRhdGFbaW5kZXhdLmlzU2hvdyA9IHRydWU7DQogICAgICB0aGlzLmxpc3QgPSBkYXRhOw0KICAgIH0sDQogICAgZ2V0QXJ0aWNsZSgpIHsNCiAgICAgIGdldEFydGljbGVzKCkudGhlbihyZXMgPT4gew0KICAgICAgICBsZXQgbGlzdCA9IHJlcy5kYXRhLmRhdGE7DQogICAgICAgIGxpc3QgPSBsaXN0Lm1hcChlID0+IHsNCiAgICAgICAgICBlLmlzU2hvdyA9IGZhbHNlOw0KICAgICAgICAgIHJldHVybiBlOw0KICAgICAgICB9KTsNCiAgICAgICAgdGhpcy5saXN0ID0gbGlzdDsNCiAgICAgICAgdGhpcy5pc1JlZnJlc2ggPSBmYWxzZTsNCiAgICAgIH0pOw0KICAgIH0sDQogICAgc3VibWl0KGluZGV4KSB7DQogICAgICBhZGRDb21tZW50KHsgaWQ6IHRoaXMubGlzdFtpbmRleF0uX2lkLCBjb250ZW50OiB0aGlzLmNvbnRlbnQgfSkudGhlbigNCiAgICAgICAgcmVzID0+IHsNCiAgICAgICAgICBpZiAocmVzLnN0YXR1cyA9PT0gMjAwKSB7DQogICAgICAgICAgICB0aGlzLmdldEFydGljbGUoKTsNCiAgICAgICAgICAgIHJldHVybiB0aGlzLiRub3RpZnkoeyB0eXBlOiAic3VjY2VzcyIsIG1lc3NhZ2U6IHJlcy5kYXRhLm1lc3NhZ2UgfSk7DQogICAgICAgICAgfQ0KICAgICAgICAgIHRoaXMuJG5vdGlmeShyZXMuZGF0YS5tZXNzYWdlKTsNCiAgICAgICAgfQ0KICAgICAgKTsNCiAgICB9LA0KICAgIG9uUmVmcmVzaCgpIHsNCiAgICAgIHRoaXMuZ2V0QXJ0aWNsZSgpOw0KICAgIH0NCiAgfSwNCiAgZmlsdGVyczogew0KICAgIHBhcnNlTWVzc2FnZVRpbWUob2xkX3RpbWUpIHsNCiAgICAgIGxldCBub3cgPSBuZXcgRGF0ZSgpLA0KICAgICAgICBvbGQgPSBuZXcgRGF0ZShvbGRfdGltZSksDQogICAgICAgIG5vd195ZWFyID0gbm93LmdldEZ1bGxZZWFyKCksDQogICAgICAgIG9sZF95ZWFyID0gb2xkLmdldEZ1bGxZZWFyKCksDQogICAgICAgIG5vd19tb250aCA9IG5vdy5nZXRNb250aCgpICsgMSwNCiAgICAgICAgb2xkX21vbnRoID0gb2xkLmdldE1vbnRoKCkgKyAxLA0KICAgICAgICBub3dfZGF0ZSA9IG5vdy5nZXREYXRlKCksDQogICAgICAgIG9sZF9kYXRlID0gb2xkLmdldERhdGUoKSwNCiAgICAgICAgZm9ybWF0X21vbnRoID0gb2xkX21vbnRoLnRvU3RyaW5nKCkucGFkU3RhcnQoMiwgIjAiKSwNCiAgICAgICAgZm9ybWF0X2RhdGUgPSBvbGRfZGF0ZS50b1N0cmluZygpLnBhZFN0YXJ0KDIsICIwIiksDQogICAgICAgIGZvcm1hdF9taW51dGVzID0gb2xkDQogICAgICAgICAgLmdldE1pbnV0ZXMoKQ0KICAgICAgICAgIC50b1N0cmluZygpDQogICAgICAgICAgLnBhZFN0YXJ0KDIsICIwIiksDQogICAgICAgIGRheUFyciA9IFsNCiAgICAgICAgICAi5pif5pyf5pelIiwNCiAgICAgICAgICAi5pif5pyf5LiAIiwNCiAgICAgICAgICAi5pif5pyf5LqMIiwNCiAgICAgICAgICAi5pif5pyf5LiJIiwNCiAgICAgICAgICAi5pif5pyf5ZubIiwNCiAgICAgICAgICAi5pif5pyf5LqUIiwNCiAgICAgICAgICAi5pif5pyf5YWtIg0KICAgICAgICBdOw0KICAgICAgaWYgKG5vd195ZWFyID09IG9sZF95ZWFyKSB7DQogICAgICAgIGlmIChub3dfbW9udGggPT0gb2xkX21vbnRoICYmIG5vd19kYXRlIC0gb2xkX2RhdGUgPCA3KSB7DQogICAgICAgICAgaWYgKG5vd19kYXRlID09IG9sZF9kYXRlKSB7DQogICAgICAgICAgICByZXR1cm4gYCR7b2xkLmdldEhvdXJzKCl9OiR7Zm9ybWF0X21pbnV0ZXN9YDsNCiAgICAgICAgICB9IGVsc2UgaWYgKG5vd19kYXRlID09IG9sZF9kYXRlICsgMSkgew0KICAgICAgICAgICAgcmV0dXJuICLmmKjlpKkiOw0KICAgICAgICAgIH0gZWxzZSBpZiAobm93X2RhdGUgPT0gb2xkX2RhdGUgKyAyKSB7DQogICAgICAgICAgICByZXR1cm4gIuWJjeWkqSI7DQogICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgIHJldHVybiBkYXlBcnJbb2xkLmdldERheSgpXTsNCiAgICAgICAgICB9DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgcmV0dXJuIGAke2Zvcm1hdF9tb250aH0tJHtmb3JtYXRfZGF0ZX1gOw0KICAgICAgICB9DQogICAgICB9IGVsc2Ugew0KICAgICAgICByZXR1cm4gYCR7b2xkX3llYXJ9LSR7Zm9ybWF0X21vbnRofS0ke2Zvcm1hdF9kYXRlfWA7DQogICAgICB9DQogICAgfQ0KICB9DQp9Ow0K"},{"version":3,"sources":["articleDetail.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAsGA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"articleDetail.vue","sourceRoot":"src/components/Home","sourcesContent":["<template>\r\n  <div style=\"height:100%;wdith:100%;\">\r\n      <van-nav-bar\r\n        id=\"dynamictitle\"\r\n        title=\"Friends Dynamics\"\r\n        left-arrow\r\n        @click-left=\"$router.back()\"\r\n        @click-right =\"addShow = true\"\r\n      >\r\n        <van-icon id=\"addshow\" name=\"plus\" slot=\"right\" />\r\n      </van-nav-bar>\r\n      <van-pull-refresh v-model=\"isRefresh\" @refresh=\"onRefresh\" style=\"height:100%;\">\r\n      <ul>\r\n        <div id=\"notingdynamic\"\r\n          style=\"text-align: center;font-size: 20px;margin-top:100px;\"\r\n          v-if=\"list.length === 0\"\r\n        >Nothing....</div>\r\n        <van-panel\r\n          id=\"nickDynamic\"\r\n          v-for=\"(item,index) in list\"\r\n          :key=\"index\"\r\n          :title=\"item.owner.nickName\"\r\n          :desc=\"item.created\"\r\n          style=\"margin-bottom:16px;box-shadow: 0 5px 15px -5px rgba(0, 0, 0, 0.5); background:#fff;\"\r\n        >\r\n          <div slot=\"header\" style=\"font-size: 16px;overflow:hidden;padding: 10px 16px 0;\">\r\n            <div style=\"float:left;margin-right: 14px;\">\r\n              <van-image\r\n                id=\"avatarDynamic\"\r\n                fit=\"cover\"\r\n                round\r\n                width=\"40px\"\r\n                height=\"40px\"\r\n                :src=\"item.owner.avatar\"\r\n                slot=\"icon\"\r\n              />\r\n            </div>\r\n            <div id=\"mynickname\" style=\"margin-top:5px;\">{{item.owner.nickName}}</div>\r\n            <div\r\n               id=\"time\"\r\n              style=\"font-size: 14px;color: #777;margin-top:5px;\"\r\n            >{{item.created | parseMessageTime}}</div>\r\n          </div>\r\n          <div id=\"content\" style=\"font-size: 18px;padding: 0 16px;margin-top:10px;\">{{item.content}}</div>\r\n          <div slot=\"footer\">\r\n            <p v-for=\"(v,i) in item.comments\" :key=\"v+i\" style=\"font-size:16px;\">\r\n              <span id=\"usercontnet\" style=\"color: blue;font-size: 16px;\">{{v.user.nickName}}:</span>//留言\r\n              {{v.content}}\r\n            </p>\r\n            <div style=\"text-align:right;\">\r\n              <van-icon\r\n                id=\"contentshow\"\r\n                v-show=\"!item.isShow\"\r\n                @click=\"show(index)\"\r\n                name=\"comment-o\"\r\n                style=\"font-size:24px;\"\r\n              />\r\n              <div v-show=\"item.isShow\" class=\"cell\">\r\n                <van-button id=\"send\" style=\"float:right;\" round type=\"info\" @click=\"submit(index)\">send</van-button>\r\n                <van-cell-group>\r\n                  <van-field\r\n                    id=\"leavecontent\"\r\n                    style=\"background: #eee;\"\r\n                    v-model=\"content\"\r\n                    rows=\"1\"\r\n                    autosize\r\n                    type=\"textarea\"\r\n                    placeholder=\"Comment\"\r\n                  />\r\n                </van-cell-group>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </van-panel>\r\n      </ul>\r\n    </van-pull-refresh>\r\n    <van-popup v-model=\"addShow\" position=\"top\" style=\"height:100%;width:100%;background: #eee;\">\r\n      <van-nav-bar id=\"newDynamic\" title=\"New Dynamics\" left-arrow @click-left=\"addShow = false\" />//发布动态\r\n      <van-cell-group style=\" box-shadow: 0 5px 15px -5px rgba(0, 0, 0, 0.5);margin-top:16px;\">\r\n        <van-field\r\n          id=\"sharecontent\"\r\n          round\r\n          v-model=\"message\"\r\n          rows=\"5\"\r\n          autosize\r\n          type=\"textarea\"\r\n          placeholder=\"share your happy things...\"\r\n        />\r\n      </van-cell-group>\r\n      <van-button\r\n        id=\"butnsend\"\r\n        @click=\"create\"\r\n        round\r\n        type=\"info\"\r\n        size=\"large\"\r\n        style=\"box-shadow: 0 5px 15px -5px rgba(0, 0, 0, 0.5);margin-top:16px;\"\r\n      >Send</van-button>//发布\r\n    </van-popup>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { createArticle, getArticles, addComment } from \"@/api/article\";\r\n\r\nexport default {\r\n  name: \"Article\",\r\n  data() {\r\n    return {\r\n      list: [],\r\n      content: \"\",\r\n      isShow: false,\r\n      addShow: false,\r\n      message: \"\",\r\n      scroll: \"\",\r\n      isRefresh: false\r\n    };\r\n  },\r\n  created() {\r\n    this.getArticle();\r\n  },\r\n  methods: {\r\n    create() {\r\n      createArticle({ content: this.message }).then(res => {\r\n        if (res.status === 200) {\r\n          this.message = \"\";\r\n          this.addShow = false;\r\n          this.getArticle();\r\n          return this.$notify({ type: \"success\", message: res.data.message });\r\n        }\r\n        this.$notify(res.data.message);\r\n      });\r\n    },\r\n    show(index) {\r\n      this.content = \"\";\r\n      let data = this.list;\r\n      data = data.map(e => {\r\n        e.isShow = false;\r\n        return e;\r\n      });\r\n      data[index].isShow = true;\r\n      this.list = data;\r\n    },\r\n    getArticle() {\r\n      getArticles().then(res => {\r\n        let list = res.data.data;\r\n        list = list.map(e => {\r\n          e.isShow = false;\r\n          return e;\r\n        });\r\n        this.list = list;\r\n        this.isRefresh = false;\r\n      });\r\n    },\r\n    submit(index) {\r\n      addComment({ id: this.list[index]._id, content: this.content }).then(\r\n        res => {\r\n          if (res.status === 200) {\r\n            this.getArticle();\r\n            return this.$notify({ type: \"success\", message: res.data.message });\r\n          }\r\n          this.$notify(res.data.message);\r\n        }\r\n      );\r\n    },\r\n    onRefresh() {\r\n      this.getArticle();\r\n    }\r\n  },\r\n  filters: {\r\n    parseMessageTime(old_time) {\r\n      let now = new Date(),\r\n        old = new Date(old_time),\r\n        now_year = now.getFullYear(),\r\n        old_year = old.getFullYear(),\r\n        now_month = now.getMonth() + 1,\r\n        old_month = old.getMonth() + 1,\r\n        now_date = now.getDate(),\r\n        old_date = old.getDate(),\r\n        format_month = old_month.toString().padStart(2, \"0\"),\r\n        format_date = old_date.toString().padStart(2, \"0\"),\r\n        format_minutes = old\r\n          .getMinutes()\r\n          .toString()\r\n          .padStart(2, \"0\"),\r\n        dayArr = [\r\n          \"星期日\",\r\n          \"星期一\",\r\n          \"星期二\",\r\n          \"星期三\",\r\n          \"星期四\",\r\n          \"星期五\",\r\n          \"星期六\"\r\n        ];\r\n      if (now_year == old_year) {\r\n        if (now_month == old_month && now_date - old_date < 7) {\r\n          if (now_date == old_date) {\r\n            return `${old.getHours()}:${format_minutes}`;\r\n          } else if (now_date == old_date + 1) {\r\n            return \"昨天\";\r\n          } else if (now_date == old_date + 2) {\r\n            return \"前天\";\r\n          } else {\r\n            return dayArr[old.getDay()];\r\n          }\r\n        } else {\r\n          return `${format_month}-${format_date}`;\r\n        }\r\n      } else {\r\n        return `${old_year}-${format_month}-${format_date}`;\r\n      }\r\n    }\r\n  }\r\n};\r\n</script>\r\n\r\n<style scoped lang=\"less\">\r\np {\r\n  font-size: 20px;\r\n  margin-bottom: 10px;\r\n}\r\n.cell .van-cell {\r\n  width: 90%;\r\n  margin: auto;\r\n}\r\n.cell .van-cell-group {\r\n  width: 83%;\r\n  background: #eee;\r\n}\r\n</style>"]}]}